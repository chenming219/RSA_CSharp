using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using we_secret;

namespace we_rsa_test
{
    class Program
    {
        static void Main(string[] args)
        {
            var deal_rsa = new deal_rsa();
            var key_type = We.Security.RSA.KeyFormat.XML;
            deal_rsa.gen_rsa_key(1024, key_type);

            string pub_key = deal_rsa.get_pub_key();

            string pri_key = deal_rsa.get_pri_key();

            string de_data = "1234567812345678123456781234567812345678123456781234567812123456781234567812345678123456781234567812345678123456781234567812345678121234567812345678123456781234567812345678123456781234567812123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456783456781234567812345678123456781234567812345678123456781234567812345678312345678123456781234567812345678123456781234567812345678121234567812345678123456781234567812345678123456781234567812345678123456781212345678123456781234567812345678123456781234567812345678121234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567834567812345678123456781234567812345678123456781234567812345678123456783456781234567812345678123456781234567812345678123456783456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781212345678123456781234567812345678123456781234567812345678123456781234567812123456781234567812345678123456781234567812345678123456781212345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678345678123456781234567812345678123456781234567812345678123456781234567831234567812345678123456781234567812345678123456781234567812123456781234567812345678123456781234567812345678123456781234567812345678121234567812345678123456781234567812345678123456781234567812123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456783456781234567812345678123456781234567812345678123456781234567812345678345678123456781234567812345678123456781234567812345678345678123456781234567812345678123456781234567812345678123456781234567845678123456781234567812345678123456781234567812345678345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678121234567812345678123456781234567812345678123456781234567812345678123456781212345678123456781234567812345678123456781234567812345678121234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567834567812345678123456781234567812345678123456781234567812345678123456783123456781234567812345678123456781234567812345678123456781212345678123456781234567812345678123456781234567812345678123456781234567812123456781234567812345678123456781234567812345678123456781212345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678345678123456781234567812345678123456781234567812345678123456781234567834567812345678123456781234567812345678123456781234567834567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812123456781234567812345678123456781234567812345678123456781234567812345678121234567812345678123456781234567812345678123456781234567812123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456783456781234567812345678123456781234567812345678123456781234567812345678312345678123456781234567812345678123456781234567812345678121234567812345678123456781234567812345678123456781234567812345678123456781212345678123456781234567812345678123456781234567812345678121234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567812345678123456781234567834567812345678123456781234567812345678123456781234567812345678123456783456781234567812345678123456781234567812345678123456783456781234567812345678123456781234567812345678123456781234567812345678456781234567812345678123456781234567812345678123456783456781234567812345678123456781234567812345678123456781234567812345678456781234567812345678123456781234567812345678123456783456781234567812345678123456781234567812345678123456781234567812345678456781234567812345678123456781234567812345678123456783456781234567812345678123456781234567812345678123456781234567812345678";
            var en_data = deal_rsa.rsa_pubkey_encrypt(pub_key, de_data, key_type);
            var dde_data = deal_rsa.rsa_prikey_decrypt(pri_key, en_data, key_type);

            var sign = deal_rsa.rsa_prikey_sign(pri_key, en_data, key_type);

            var check_sign = deal_rsa.rsa_pubkey_verify(pub_key, en_data, sign, key_type);

            Console.Write("DEAL OVER");
        }
    }
}
